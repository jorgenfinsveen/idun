MESA: warning: ../src/vulkan/runtime/vk_nir.c:56: SPIR-V offset 28: SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4818
    Unsupported SPIR-V capability: SpvCapabilityRuntimeDescriptorArray (5302)
    28 bytes into the SPIR-V binary
SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4818
    Unsupported SPIR-V capability: SpvCapabilityRuntimeDescriptorArray (5302)
    28 bytes into the SPIR-V binary
MESA: warning: ../src/vulkan/runtime/vk_nir.c:56: SPIR-V offset 28: SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4798
    Unsupported SPIR-V capability: SpvCapabilityShaderNonUniform (5301)
    28 bytes into the SPIR-V binary
SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4798
    Unsupported SPIR-V capability: SpvCapabilityShaderNonUniform (5301)
    28 bytes into the SPIR-V binary
MESA: warning: ../src/vulkan/runtime/vk_nir.c:56: SPIR-V offset 36: SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4818
    Unsupported SPIR-V capability: SpvCapabilityRuntimeDescriptorArray (5302)
    36 bytes into the SPIR-V binary
SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4818
    Unsupported SPIR-V capability: SpvCapabilityRuntimeDescriptorArray (5302)
    36 bytes into the SPIR-V binary
MESA: warning: ../src/vulkan/runtime/vk_nir.c:56: SPIR-V offset 28: SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4798
    Unsupported SPIR-V capability: SpvCapabilityShaderNonUniform (5301)
    28 bytes into the SPIR-V binary
SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4798
    Unsupported SPIR-V capability: SpvCapabilityShaderNonUniform (5301)
    28 bytes into the SPIR-V binary
MESA: warning: ../src/vulkan/runtime/vk_nir.c:56: SPIR-V offset 36: SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4818
    Unsupported SPIR-V capability: SpvCapabilityRuntimeDescriptorArray (5302)
    36 bytes into the SPIR-V binary
SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4818
    Unsupported SPIR-V capability: SpvCapabilityRuntimeDescriptorArray (5302)
    36 bytes into the SPIR-V binary
MESA: warning: ../src/vulkan/runtime/vk_nir.c:56: SPIR-V offset 28: SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4798
    Unsupported SPIR-V capability: SpvCapabilityShaderNonUniform (5301)
    28 bytes into the SPIR-V binary
SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4798
    Unsupported SPIR-V capability: SpvCapabilityShaderNonUniform (5301)
    28 bytes into the SPIR-V binary
MESA: warning: ../src/vulkan/runtime/vk_nir.c:56: SPIR-V offset 36: SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4818
    Unsupported SPIR-V capability: SpvCapabilityRuntimeDescriptorArray (5302)
    36 bytes into the SPIR-V binary
SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4818
    Unsupported SPIR-V capability: SpvCapabilityRuntimeDescriptorArray (5302)
    36 bytes into the SPIR-V binary
MESA: warning: ../src/vulkan/runtime/vk_nir.c:56: SPIR-V offset 28: SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4798
    Unsupported SPIR-V capability: SpvCapabilityShaderNonUniform (5301)
    28 bytes into the SPIR-V binary
SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4798
    Unsupported SPIR-V capability: SpvCapabilityShaderNonUniform (5301)
    28 bytes into the SPIR-V binary
MESA: warning: ../src/vulkan/runtime/vk_nir.c:56: SPIR-V offset 36: SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4818
    Unsupported SPIR-V capability: SpvCapabilityRuntimeDescriptorArray (5302)
    36 bytes into the SPIR-V binary
SPIR-V WARNING:
    In file ../src/compiler/spirv/spirv_to_nir.c:4818
    Unsupported SPIR-V capability: SpvCapabilityRuntimeDescriptorArray (5302)
    36 bytes into the SPIR-V binary
RayTracer: ../src/gallium/auxiliary/util/u_surface.c:267: util_resource_copy_region: Assertion `src_bs == dst_bs' failed.
/var/slurm_spool/job23022844/slurm_script: line 61: 4102288 Aborted                 (core dumped) apptainer exec --nv ~/container-setup/vulkan-sim-base.sif bash -lc '
  set -eo pipefail

  export ROOT="$HOME/vulkan-sim-root"
  export MESA_SIM="$ROOT/mesa-vulkan-sim/lib"
  export LD_LIBRARY_PATH="$MESA_SIM/lib/x86_64-linux-gnu:$MESA_SIM/lib:$ROOT/vulkan-sim:${LD_LIBRARY_PATH:-}"
  export VK_ICD_FILENAMES="$MESA_SIM/share/vulkan/icd.d/lvp_icd.x86_64.json"


  DEVICE_CONFIG="$ROOT/vulkan-sim/configs/tested-cfgs/MOBILE_SIM_2"
  SCENE=18
  WIDTH=256
  HEIGHT=256
  SAMPLES=5
  SHADER=1


  SIM_MODE=$(awk '"'"'/^[[:space:]]*-gpgpu_ptx_sim_mode[[:space:]]+/ {print $2; exit}'"'"' "$DEVICE_CONFIG/gpgpusim.config")
  OS=$(grep PRETTY_NAME /etc/os-release | cut -d= -f2- | tr -d \")
  CPU=$(lscpu | grep "Model name:" | cut -d: -f2- | sed "s/^[ \t]*//")
  RAM=$(free -h | awk '"'"'/^Mem:/ {print $2}'"'"')

  echo -e "\n\nENVIRONMENT INFO\n---------------------------"
  echo -e "\t- OS:\t $OS"
  echo -e "\t- CPU:\t $CPU"
  echo -e "\t- RAM:\t $RAM\n"
  nvidia-smi || true

  echo -e "\n\nSIMULATION SETUP\n---------------------"
  echo -e "\t- Device config:\t $DEVICE_CONFIG"
  echo -e "\t- gpgpu_ptx_sim_mode:\t $SIM_MODE"
  echo -e "\t- Scene:\t\t $SCENE"
  echo -e "\t- Dimensions:"
  echo -e "\t\t- Width:\t $WIDTH"
  echo -e "\t\t- Height:\t $HEIGHT"
  echo -e "\t- Samples:\t\t $SAMPLES"
  echo -e "\t- Shader type:\t\t $SHADER"
  echo -e "\n\n\n\nSTARTING SIMULATION...\n--------------------------------------------------------\n\n\n"

  set +u
  source "$ROOT/vulkan-sim/setup_environment"
  cd "$ROOT/RayTracingInVulkan/build/linux/bin"
  cp "$DEVICE_CONFIG/"* "./."

  ./RayTracer --scene $SCENE --width $WIDTH --height $HEIGHT --samples $SAMPLES --shader-type $SHADER
'
